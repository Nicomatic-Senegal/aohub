<div class="main">
  <app-side-bar class="app-side" [screen]="'/projets'"></app-side-bar>
  <div class="head-home" >
    <app-top-bar class="w-full flex-grow-1 " title="{{'MY PROJECTS' | translate}}"></app-top-bar>
    <div class="div-center">
      <div class="nav">
        <button (click)="nextScreeen(1)" [ngClass]="screen === 1 ? 'text-[#408A7E] border-b-2 border-[#408A7E] ' : ''">Suivi de mes opportunités</button>
      </div>

      <div class="rounded-2xl bg-white h-full w-full p-3 overflow-auto">
        <ng-container *ngFor="let project of paginatedProjects; let i = index">
          <div *ngIf="listProject.length === 0" class="mt-[10%] mb-[10%] flex items-center justify-center">
            <div class="text-center">
              <p class="text-3xl font-bold mb-4">Aucun projet trouvé</p>
              <p class="text-lg text-gray-600">Vous n'avez actuellement aucun projet en cours</p>
            </div>
          </div>

          <div *ngIf="listProject.length !== 0" class="">
            <p class="text-[#408A7E] text-xl font-semibold font-dmsans mt-10">Liste des positionnés sur le projet: <span class="font-bold">{{project.title}}</span></p>
            <div class="w-full rounded-lg mt-3 mb-5 flex items-center">
              <p class=" text-md font-semibold text-[#161616] font-dmsans mr-5">Rallonger le délai pour se positionner sur cette opportunité de :</p>
              <form [formGroup]="myForm" (ngSubmit)="extendDeadlineForOpportunity(project.id, project.deadlinePositioning!, project.createdAt!)" class="flex items-center">
                <input type="number" formControlName="nbDays" class="input">
                <label for="nbDays" class="text-base font-dmsans text-black">jour(s)</label>
                <button type="submit" class="rounded-lg text-base text-white font-dmsans px-6 py-1 bg-[#408A7E] shadow-md ml-10">Valider</button>
              </form>
            </div>
            <table class="table-fixed">
              <thead>
                <tr>
                  <th>Prénoms - Nom</th>
                  <th>Disponibilité</th>
                  <th>Email</th>
                  <th>Entreprise</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody class="break-all">
                <tr *ngFor="let item of positioners[project.id]; let j = index">
                  <td>{{item?.partner?.user?.firstName}} {{item?.partner?.user?.lastName}} </td>
                  <!-- <td>
                    <p *ngFor="let item of getAllDisponibility(item.disponibilities)">{{ item | date: 'EEE, dd MMM à HH:mm' : 'fr' }}</p>
                  </td> -->
                  <td>
                    <div class="dropdown-wrapper">
                      <select>
                        <option *ngFor="let item of getAllDisponibility(item.disponibilities)" [value]="item">{{ item | date: 'EEE, dd MMM à HH:mm' : 'fr' }}</option>
                      </select>
                    </div>
                  </td>

                  <td>{{item?.partner?.user?.login}} </td>
                  <td>{{item?.partner?.enterprise?.name}} </td>
                  <td *ngIf="status(item?.status) === 1">
                    Accepté
                  </td>
                  <td *ngIf="status(item?.status) === 2">
                    Rejeté
                  </td>
                  <td *ngIf="status(item?.status) === 3">
                    <button (click)="rejectPositioning(project.id, j, item.id)" class="rounded-lg text-base text-white font-dmsans px-6 py-1 bg-[#EE1B22] shadow-md mr-3 mb-3">Rejeter</button>
                    <button (click)="validatePositioning(project.id, j, item.id)" class="rounded-lg text-base text-white font-dmsans px-6 py-1 bg-[#408A7E] shadow-md">Valider</button>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="border-b-2 border-[#737373]/40 text-[#737373] w-full my-5"></div>
          </div>

        </ng-container>

        <app-paginator
          *ngIf="listProject.length !== 0"
          [totalItems]="totalItems"
          [itemPerPage]="itemPerPage"
          [currentPage]="currentPage"
          (onClick)="changePage($event)">
        </app-paginator>
      </div>
    </div>
  </div>

</div>
